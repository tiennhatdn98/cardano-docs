Source: https://iohk.io/en/blog/posts/2020/03/26/enter-the-hydra-scaling-distributed-ledgers-the-evidence-based-way/

3 main problems of scaling: high transaction throughput (thông lượng transacton cao), low latency (độ trễ thấp), minimal storage per node (bộ nhớ mỗi node tối thiểu)

Hydra scability architecture: the head protocol, the tail protocol, the cross-head-and-tail communication protocol, as well as of supporting protocols for routing, reconfiguration, and virtualization

The centerpiece (trọng tâm) is head protocol, cho phép tập hợp những người tham gia (participants) high-performance and high-availability (such as stake pools) xử lý nhanh số lượng lớn transaction với yêu cầu bộ nhớ tối thiểu thông qua multipary state channel (kênh state đa bên) - một khái niệm mà tạo ra kênh thanh toán hai chiều khi được triển khai trong Lightning network. Nó được hoàn thành bởi tail protocol, nó cho phép những người tham gia high-performance này cung cấp khả năng mở rộng cho số lượng lớn end-users, những người mà có thể sử dụng hệ thống từ thiết bị năng lượng thấp (low-power devices) như là điện thoại di dộng và những người có thể ngoại tuyến trong một khoảng thời gian. Khi heads và tails có thể giao tiếp thông qua Cardano mainchain, thì cross-head-and-tail communication protocol cung cấp một biến thể off-chain hiệu quả của tính năng này. Tất cả được gắn với nhau bằng việc định tuyến (routing) và quản lý cấu hình (configuration management), trong khi ảo hóa tạo điều kiện giao tiếp nhanh hơn, tổng quát hóa giao tiếp đầu cuối (head and tail communication)

The Hydra head protocol: là thành phần đầu tiên của kiến trúc Hydra được phát hành công khai. Nó cho phép tập hợp những người tham gia (participants) tạo một kênh state off-chain (gọi là head) trong đó họ có thể chạy smart contract (hoặc xử lý các transaction đơn giản hơn) với nhau mà không cần tương tác với blockchain trong trường hợp lạc quan (optimistic case) khi tất cả người tham gia tuân thủ (adhere) giao thức. State channel cung cấp một cách giải quyết nhanh và thông lượng transaction cao; hơn nữa, nó yêu cầu bộ nhớ rất nhỏ, vì lịch sử off-chain transaction có thể bị xóa ngay khi trạng thái kết quả được bảo mật thong qua off-chain 'snapshot' operation.

Ngay cả trong trường hợp bi quan khi số lượng người tham gia không tuân thủ protocol, sự an toàn vẫn được đảm bảo một cách nghiêm ngặt (rigorously). Bất cứ khi nào, khi có bất kỳ người tham gia có thể tạo head's 'closure' với kết quả là head's state được chuyển trở lại cho blockchain (kém hiệu quả hơn). Chúng ta nhấn mạnh rằng việc thực thi của bất kỳ smart contract nào có thể được tiếp tục liền mạch trên on-chain. Không có quỹ nào có thể được tạo ở off-chain, hoặc bất kỳ ai, head participant có thể bị mất bất kỳ khoản tiền nào.

Các state channels được áp dụng bởi Hydra are isomorphic (đẳng tích) có nghĩa là chúng sử dụng định dạng transaction giống nhau và contract code như blockchain cơ bản (underlying blockchain): contract có thể được chuyển trực tiếp qua lại giữa các channels và blockchain. Do đó, state channels mang lại hiệu quả song song, off-chain ledger siblings. Nói cách khác, sổ cái trở nên multi-headed.

Xác thực transaction ở head được thực hiện đồng thời hoàn toàn bằng quy trình chứng nhận off-chain bất đồng bộ (asynchronous off-chain vertification process) sử dụng đa chữ kỹ (multi-signatures). High level of parallelism này được kích hoạt bằng cách sử dụng EUTxO. Các dependencies transaction trong EUTxO là rõ ràng, cho phép cập nhật state mà không cần tuần tự hóa các giao dịch độc lập với nhau (without unnecessary sequentialization of transactions that are independent of each other).

![alt text for screen readers](/hydra.png "Hydra Protocol").

`Thí nghiệm xác thực của Hydra head protocol`
Bước đầu tiên hướng tới việc thực nghiệm xác thực hiệu suất của Hydra head protocol, chúng tôi đã triển khai một mô phỏng. Mô phỏng được tham số hóa theo thời gian yêu cầu của các hành động riêng lẻ (xác thực giao dịch, xác minh chữ ký...) và thực hiện mô phỏng thực tế và đúng thời gian của một cụm các node phân tán tạo thành head. Điều này dẫn đến thời gian xác nhận giao dịch thực tế và tính toán thông lượng.

Chúng tôi thấy rằng một Hydra head đạt được khoảng 1.000 TPS, vì vậy bằng cách chạy song song 1.000 head (ví dụ một head cho mỗi stake pool của Shelly), chúng ta sẽ đạt được 1 triệu TPS. Điều đó thật ấn tượng và đưa chúng tôi đi trước đối thủ nhiều bước, nhưng tại sao chúng ta phải dừng lại ở đó? 2.000 head sẽ cho chúng ta 2 triệu TPS và nếu ai đó yêu cầu 1 tỷ TPS, thì chúng ta có thể yêu cầu họ chỉ cần chạy 1 triệu head. Hơn nữa, các cải tiến hiệu suất khác nhau trong việc triển khai có thể cải thiện phép đo 1000 TPS trong một head đơn lẻ, bổ sung thêm vào hiệu suất giả định của protocol.

Vì vậy, chúng ta có thể đạt được bất kỳ số TPS nào mà chúng ta muốn không? Về lý thuyết, câu trả lời là chắc chắn có, và điều đó chỉ ra một vấn đề với việc sử dụng TPS làm thước đo để so sánh các hệ thống. Mặc dù có xu hướng giảm mức độ phức tạp của việc đánh giá hiệu suất giao thức xuống một con số duy nhất, nhưng trên thực tế, điều này dẫn đến việc đơn giản hóa quá mức. Nếu không có bối cảnh khác, số TPS gần như vô nghĩa, Để giải thích đúng và so sánh, bạn nên hỏi kích thước của cụm (cluster) (ảnh hưởng đến chi phí giao tiếp (communication overhead)); sự phân bố của nó (xác định lượng thời gian để thông tin chuyển qua hệ thống); chất lượng dịch vụ bị ảnh hưởng như thế nào bởi tỉ lệ transaction cao (thời gian xác nhận transaction, cung cấp dữ liệu cho người dùng cuối); độ lớn và độ phức tạp của các transaction (có ảnh hưởng đến thời gian xác thực transaction, thời gian truyền thông điệp, yêu cầu đối với hệ thống lưu trữ cục bộ (local storage system), thành phần của những head tham gia); và loại phần cứng và kết nối mạng nào đã được sử dụng trong các thử nghiệm. Chỉ thay đổi mức độ phức tạp của các transaction có thể thay đổi TPS theo hệ số ba (refer to Section 7 - Simulations)

### Hydra Head in a nutshell

Hydra Head là một kênh state secure isomorphic. Nói một cách đơn giản, nó là một sổ cái mini off-chain giữa một nhóm hạn chế những người tham gia, hoạt động tương tự (mặc dù nhanh hơn đáng kể) với sổ cái chỉnh trên on-chain.

Điều đầu tiên cần hiểu là channel là một đường giao tiếp giữa 2 hoặc nhiều peers. Để trở thành một phần của Head có nghĩa là thành một trong các peers. Các channel tạo thành mạng riêng biệt có thể phát triển song song với mạng chính. Trên các mạng thay thế này, những người tham gia tuân theo một thuật toán đồng thuận khác: mọi người cần đồng ý tất cả transaction đi qua. Hệ quả của việc này là, với tư cách là một người tham gia, tôi không thể mất tiền mà tôi đã không đồng ý một cách rõ ràng để mất tiền. Tại sao? Vì bất cứ một việc xác minh transaction nào cũng yêu cầu sự chấp thuận rõ ràng.

Khi hình thành một Head, những người tham gia có thể commit tiền vô. Nghĩa là chuyển tiền từ on-chain sang script address khóa lại bằng các rules xác định. Script đảm bảo việc thực thi an toàn của giao thức on-chain, và đặc biệt, những người tham gia không thể gian lận lẫn nhau. Tuy nhiên vào bất kỳ lúc nào, bất kỳ người tham gia nào có thể quyết định rời khỏi Head bằng cách close nó. Trong trường hợp này, tất cả người tham gia đi đến state mới nhất mà họ đã đồng ý với off-chain, trên mạng song song của họ.

Hãy coi Head như là bàn poker riêng tư nơi mà những người tham gia mang chip đến để chơi. Những người tham gia có thể chơi bao lâu tùy ý. Nếu ai đó không chơi nữa thì game sẽ không được tiếp tục. Tuy nhiên, người tham gia vẫn có thể tự do rời đi cùng với chip của họ. Nếu họ làm vậy, game sẽ kết thúc với số chip được phân bổ hiện tại.

![alt text for screen readers](/poker.png "Private poker table").
